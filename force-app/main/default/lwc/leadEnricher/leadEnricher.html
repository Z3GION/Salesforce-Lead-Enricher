<template>
    <lightning-card title="Lead Enricher" icon-name="standard:news">
        <div class="slds-var-p-around_medium">
            <!-- Search Section -->
            <div class="slds-grid slds-gutters slds-var-m-bottom_medium">
                <div class="slds-col slds-size_3-of-4">
                    <lightning-input label="Search Topic" value={searchTerm} onchange={handleSearchChange}
                        placeholder="e.g. Technology, Finance, AI" type="search">
                    </lightning-input>
                </div>
                <div class="slds-col slds-size_1-of-4 slds-align-bottom">
                    <lightning-button variant="brand" label="Search News" title="Search News" onclick={handleSearch}
                        class="slds-var-m-left_small">
                    </lightning-button>
                </div>
            </div>

            <!-- Loading Spinner -->
            <template if:true={isLoading}>
                <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
            </template>

            <!-- Results Section -->
            <template if:true={results}>
                <div class="slds-grid slds-wrap slds-gutters">
                    <template for:each={results} for:item="article" for:index="index">
                        <div key={article.url}
                            class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-3 slds-var-m-bottom_medium">
                            <lightning-card variant="Narrow" class="article-card">
                                <h3 slot="title" class="article-title" title={article.title}>
                                    <a href={article.url} target="_blank">{article.title}</a>
                                </h3>
                                <div class="slds-var-p-horizontal_small">
                                    <span class="source-badge">{article.source}</span>
                                    <p class="slds-text-body_regular article-desc" title={article.description}>
                                        {article.description}
                                    </p>
                                </div>
                                <div slot="footer">
                                    <lightning-button label="Create Lead" variant="neutral" data-index={index}
                                        onclick={handleCreateLead} disabled={article.isCreated}>
                                    </lightning-button>
                                </div>
                            </lightning-card>
                        </div>
                    </template>
                </div>
            </template>

            <!-- Empty State -->
            <template if:true={hasNoResults}>
                <div class="slds-illustration slds-illustration_small slds-var-m-top_large">
                    <svg class="slds-illustration__svg" viewBox="0 0 468 194" aria-hidden="true">
                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g transform="translate(-67.000000, -121.000000)">
                                <g>
                                    <g transform="translate(245.000000, 200.000000)">
                                        <g class="slds-illustration__stroke-secondary" stroke-linecap="round"
                                            stroke-width="3">
                                            <path vector-effect="non-scaling-stroke"
                                                d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13">
                                            </path>
                                        </g>
                                    </g>
                                    <g transform="translate(135.000000, 152.000000)">
                                        <path vector-effect="non-scaling-stroke"
                                            d="M62.8890381,2.5 C60.5445435,2.5 58.4467611,3.60712206 56.7334537,5.54788283 C54.3668094,8.30609031 53,12.1074101 53,16.5 C53,25.6127441 60.6127441,33 70,33 C74.9052734,33 79.3117676,30.9565722 82.2667236,27.7517395 C84.3862305,25.4718018 86,22.2845459 86,18.5 C86,9.38725586 78.3872559,2 69,2 C65.6054688,2 62.5,3.09558105 60,5 C58.8876953,5.87255859 58,6.90759277 57.5,8">
                                        </path>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                    <div class="slds-illustration__header">
                        <h3 class="slds-text-heading_medium">No Articles Found</h3>
                    </div>
                    <div class="slds-text-body_regular">
                        <p>We couldn't find any news articles matching "{searchTerm}".</p>
                        <p>Try searching for a different topic or keyword.</p>
                    </div>
                </div>
            </template>
        </div>
    </lightning-card>
</template>